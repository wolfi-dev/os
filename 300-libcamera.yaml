# Generated from https://gitlab.alpinelinux.org/alpine/aports/-/raw/master/community/libcamera/APKBUILD
package:
  name: libcamera
  version: 0.4.0
  epoch: 0
  description: Linux camera framework
  copyright:
    - license: LGPL-2.1-or-later AND GPL-2.0-or-later

environment:
  contents:
    packages:
      - build-base
      - busybox
      - ca-certificates-bundle
      - eudev-dev
      - glib-dev
      - gnutls-dev
      - gst-plugins-bad-dev
      - qt6-qtbase-dev
      - coreutils
      - doxygen
      - graphviz
      - gtest-dev
      - libevent-dev
      - libunwind-dev
      - linux-headers
      - meson
      - py3-jinja2
      - py3-ply
      - py3-pybind11-dev
      - py3-sphinx
      - py3-yaml
      - python3-dev
      - qt6-qttools-dev
      - yaml-dev
      - libcamera-ipa

pipeline:
  - uses: fetch
    with:
      expected-sha256: c991adf9a6c0d06f1e45ea6cd3c5ee13ee27d7a7232a4c2756aa63b9813347f0
      uri: https://gitlab.freedesktop.org/camera/libcamera/-/archive/v${{package.version}}/libcamera-v${{package.version}}.tar.gz

  - uses: autoconf/configure

  - uses: autoconf/make

  - uses: autoconf/make-install

  - uses: strip

subpackages:
  - name: libcamera-dbg
    pipeline:
      - uses: split/FIXME
    description: libcamera FIXME

  - name: libcamera-dev
    pipeline:
      - uses: split/dev
    dependencies:
      runtime:
        - libcamera
        - eudev-dev
        - glib-dev
        - gnutls-dev
        - gst-plugins-bad-dev
        - qt6-qtbase-dev
        - libcamera-ipa
    description: libcamera dev

  - name: libcamera-doc
    pipeline:
      - uses: split/manpages
    description: libcamera manpages

  - name: qcam
    pipeline:
      - runs: FIXME

  - name: libcamera-gstreamer
    pipeline:
      - uses: split/FIXME
    description: libcamera FIXME

  - name: libcamera-v4l2
    pipeline:
      - uses: split/FIXME
    description: libcamera FIXME

  - name: libcamera-tools
    pipeline:
      - uses: split/FIXME
    description: libcamera FIXME

  - name: py3-libcamera
    pipeline:
      - uses: split/FIXME
    description: libcamera FIXME

  - name: libcamera-ipa
    pipeline:
      - uses: split/FIXME
    description: libcamera FIXME

test:
  environment: {}
  pipeline:
    - name: Verify libcamera installation, please improve the test as needed
      runs: libcamera --version || exit 1
