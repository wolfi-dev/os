package:
  name: accountsservice
  version: 23.13.9
  epoch: 0
  description: D-Bus interfaces for querying and manipulating user account information
  copyright:
    - license: GPL-3.0-or-later

environment:
  environment:
    CFLAGS: -Wno-implicit-function-declaration
  contents:
    packages:
      - build-base
      - busybox
      - glib-dev
      - polkit-dev
      - gobject-introspection-dev
      - glib-gir
      - vala
      - dbus-dev

pipeline:
  - uses: git-checkout
    with:
      repository: https://gitlab.freedesktop.org/accountsservice/accountsservice.git
      tag: ${{package.version}}
      expected-commit: 57e491f5e6f3da2d5a949f4f8747c8f4e8ed799d

  - uses: meson/configure
    with:
      opts: |
        -Dsystemdsystemunitdir=/usr/lib/systemd/system \
        -Dadmin_group=wheel

  - uses: meson/compile

  - uses: meson/install

  - uses: strip

update:
  enabled: true
  git: {}

subpackages:
  - name: ${{package.name}}-dev
    description: ${{package.name}} development libraries and headers
    pipeline:
      - uses: split/dev
    test:
      pipeline:
        - uses: test/pkgconf
        - uses: test/tw/ldd-check

test:
  pipeline:
    - uses: test/tw/ldd-check
