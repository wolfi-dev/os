package:
  name: bank-vaults
  version: 1.32.0
  epoch: 1 # GHSA-2464-8j7c-4cjm
  description: A Vault swiss-army knife. A CLI tool to init, unseal and configure Vault (auth methods, secret engines).
  copyright:
    - license: Apache-2.0

pipeline:
  - uses: git-checkout
    with:
      repository: https://github.com/bank-vaults/bank-vaults
      tag: v${{package.version}}
      expected-commit: 69cda1dbeb8f7a47f4e6314d60c566088967a972

  - uses: go/bump
    with:
      deps: |-
        github.com/go-viper/mapstructure/v2@v2.4.0

  - uses: go/build
    with:
      modroot: .
      output: bank-vaults
      packages: ./cmd/bank-vaults

  - uses: strip

subpackages:
  - name: bank-vaults-template
    pipeline:
      - uses: go/build
        with:
          modroot: .
          output: template
          packages: ./cmd/template
    test:
      pipeline:
        - runs: |
            template version
            template --help

update:
  enabled: true
  git:
    # There are some charts/ tags, ignore those.
    strip-prefix: v

test:
  pipeline:
    # AUTOGENERATED
    - runs: |
        bank-vaults --help
