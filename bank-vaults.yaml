package:
  name: bank-vaults
  version: "1.32.1"
  epoch: 1 # go/wolfi-rsc/bank-vaults
  description: A Vault swiss-army knife. A CLI tool to init, unseal and configure Vault (auth methods, secret engines).
  copyright:
    - license: Apache-2.0
  resources:
    cpu: "2"
    memory: 8Gi

pipeline:
  - uses: git-checkout
    with:
      repository: https://github.com/bank-vaults/bank-vaults
      tag: v${{package.version}}
      expected-commit: 5566b7805d1b39e3649eae975b26a0e73533a22b

  - uses: go/build
    with:
      modroot: .
      output: bank-vaults
      packages: ./cmd/bank-vaults

  - uses: strip

subpackages:
  - name: bank-vaults-template
    pipeline:
      - uses: go/build
        with:
          modroot: .
          output: template
          packages: ./cmd/template
    test:
      pipeline:
        - runs: |
            template version
            template --help

update:
  enabled: true
  git:
    # There are some charts/ tags, ignore those.
    strip-prefix: v

test:
  pipeline:
    # AUTOGENERATED
    - runs: |
        bank-vaults --help
