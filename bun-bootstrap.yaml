package:
  name: bun-bootstrap
  version: "1.3.4"
  epoch: 0
  description: "Bun requires itself to bootstrap."
  copyright:
    - license: MIT
  options:
    no-provides: true

environment:
  contents:
    packages:
      - bash
      - busybox
      - curl

pipeline:
  - assertions:
      required-steps: 1
    pipeline:
      - if: ${{build.arch}} == 'aarch64'
        uses: fetch
        with:
          uri: "https://github.com/oven-sh/bun/releases/download/bun-v${{package.version}}/bun-linux-aarch64.zip"
          expected-sha256: "c46e841fed85347521915b1b3904d6d175d8e2fd915e18e01c111318219115a4"
          extract: false
      - if: ${{build.arch}} == 'x86_64'
        uses: fetch
        with:
          uri: "https://github.com/oven-sh/bun/releases/download/bun-v${{package.version}}/bun-linux-x64.zip"
          expected-sha256: "33c6996049e8d37e8b815959b14b05e5b6f496121352bf11bae7d047193c28bf"
          extract: false

  - runs: |
      unzip bun*.zip
      rm *.zip
      mkdir -p ${{targets.destdir}}/usr/bin
      mv bun*/bun ${{targets.destdir}}/usr/bin/

update:
  enabled: true
  github:
    identifier: oven-sh/bun
    use-tag: true
    strip-prefix: bun-v

test:
  pipeline:
    - runs: |
        bun --version
