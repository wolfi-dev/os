package:
  name: cifs-utils
  version: "7.1"
  epoch: 2
  description: CIFS filesystem user-space tools
  copyright:
    - license: GPL-3.0-or-later

environment:
  contents:
    packages:
      - autoconf
      - automake
      - build-base
      - busybox
      - keyutils-dev
      - krb5-dev
      - libcap-dev
      - openssf-compiler-options
      - py3-docutils
      - samba-dev
      - talloc-dev

pipeline:
  - uses: fetch
    with:
      expected-sha512: 9eda85b2767cd19c7f69843750450c3862596debf47f41d9ce07f3d7438225b700b260be9585d2f7c9962d3f4dd8434b1b647c9ba670962cf136ce7ad86f92ab
      uri: https://ftp.samba.org/pub/linux-cifs/cifs-utils/cifs-utils-${{package.version}}.tar.bz2

  - uses: autoconf/configure

  - uses: autoconf/make

  - runs: |
      mkdir -p ${{targets.destdir}}/sbin
      make install DESTDIR="${{targets.destdir}}"

  - uses: strip

subpackages:
  - name: cifs-utils-dev
    pipeline:
      - uses: split/dev
    dependencies:
      runtime:
        - cifs-utils

  - name: "cifs-utils-doc"
    description: "cifs-utils documentation"
    pipeline:
      - uses: split/manpages

update:
  enabled: true
  release-monitor:
    identifier: 287

test:
  pipeline:
    # AUTOGENERATED
    - runs: |
        getcifsacl --version
        setcifsacl -v
        cifs.idmap --version
        cifs.upcall --version
        getcifsacl --help
        setcifsacl -h
        cifs.idmap --help
