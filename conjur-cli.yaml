package:
  name: conjur-cli
  description: Conjur command line interface
  version: "9.0.0"
  epoch: 0 # CVE-2025-61725

pipeline:
  - uses: git-checkout
    with:
      expected-commit: 45d7aa8ca565979eecf6f98df34f061eb2c18eb0
      repository: https://github.com/cyberark/conjur-cli-go
      tag: v${{package.version}}

  - uses: go/build
    with:
      packages: ./cmd/conjur
      output: conjur
      tidy: true
      ldflags: |
        -X "github.com/cyberark/conjur-cli-go/pkg/version.Tag=$(git rev-parse --short HEAD)"
        -X "github.com/cyberark/conjur-cli-go/pkg/version.Version=${{package.version}}"

update:
  enabled: true
  github:
    identifier: cyberark/conjur-cli-go
    strip-prefix: v
    tag-filter: v
    use-tag: true

test:
  pipeline:
    - runs: |
        conjur -v | grep ${{package.version}}
        conjur -h
