From 221d15fae131f5e89e63e628be880b320b13b55c Mon Sep 17 00:00:00 2001
From: Dimitri John Ledkov <dimitri.ledkov@surgut.co.uk>
Date: Thu, 29 Jan 2026 08:06:22 +0100
Subject: [PATCH] Patch toolchains_llvm to support wolfi

---
 bazel/repositories.bzl | 6 +++++-
 bazel/toolchains.bzl   | 4 ----
 2 files changed, 5 insertions(+), 5 deletions(-)

diff --git a/bazel/repositories.bzl b/bazel/repositories.bzl
index 8d67199043..e137634514 100644
--- a/bazel/repositories.bzl
+++ b/bazel/repositories.bzl
@@ -830,7 +830,11 @@ def _com_github_wamr():
     )
 
 def _toolchains_llvm():
-    external_http_archive(name = "toolchains_llvm")
+    external_http_archive(
+        name = "toolchains_llvm",
+        patch_args = ["-p1"],
+        patches = ["//:bazel/0001-Add-support-for-Chainguard-and-Wolfi-distributions.patch"],
+    )
 
 def _com_github_wasmtime():
     external_http_archive(
diff --git a/bazel/toolchains.bzl b/bazel/toolchains.bzl
index aa296862d7..090235839d 100644
--- a/bazel/toolchains.bzl
+++ b/bazel/toolchains.bzl
@@ -15,9 +15,5 @@ def envoy_toolchains():
         name = "llvm_toolchain",
         llvm_version = "18.1.8",
         cxx_standard = {"": "c++20"},
-        sysroot = {
-            "linux-x86_64": "@sysroot_linux_amd64//:sysroot",
-            "linux-aarch64": "@sysroot_linux_arm64//:sysroot",
-        },
         toolchain_roots = {"": LLVM_PATH} if LLVM_PATH else {},
     )
-- 
2.51.0

