package:
  name: fastjar
  version: 0.98
  epoch: 2
  description: "fast implementation of Java Archiver"
  copyright:
    - license: "GPL-2.0-or-later"

environment:
  contents:
    packages:
      - build-base
      - wolfi-base
      - zlib-dev

pipeline:
  - uses: fetch
    with:
      uri: https://download.savannah.nongnu.org/releases/fastjar/fastjar-${{package.version}}.tar.gz
      expected-sha512: c0f9fca7b58d6acd00b90a5184dbde9ba3ffc5bf4d69512743e450649a272baf1f6af98b15d79d2b53990eaf84ef402c986035e6b615a19e35ed424348143903

  - uses: patch
    with:
      patches: 0001-Properly-zero-terminate-filename.patch

  - uses: patch
    with:
      patches: 0002-Fix-write-return-value-check.patch

  - uses: autoconf/configure

  - uses: autoconf/make

  - uses: autoconf/make-install

  - uses: strip

subpackages:
  - name: "fastjar-doc"
    description: "fast implementation of Java Archiver (documentation)"
    pipeline:
      - uses: split/manpages
    test:
      pipeline:
        - uses: test/docs

update:
  enabled: true
  release-monitor:
    identifier: 14692

test:
  pipeline:
    # AUTOGENERATED
    - runs: |
        fastjar --version
        grepjar --version
        fastjar --help
        grepjar --help
