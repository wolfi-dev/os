package:
  name: freeglut
  version: "3.6.0"
  epoch: 0
  description: Free implementation of the OpenGL Utility Toolkit (GLUT)
  url: https://freeglut.sourceforge.net
  copyright:
    - license: MIT

environment:
  contents:
    packages:
      - autoconf
      - automake
      - build-base
      - busybox
      - ca-certificates-bundle
      - cmake
      - glu-dev
      - libice-dev
      - libx11-dev
      - libxi-dev
      - libxxf86vm-dev
      - mesa-dev
      - samurai

pipeline:
  - uses: git-checkout
    with:
      repository: https://github.com/freeglut/freeglut
      tag: v${{package.version}}
      expected-commit: 566cd459201ae29003ef5686c06506d8646e55c6
      cherry-picks: |
        master/2294389397912c9a6505a88221abb7dca0a4fb79: Let cmake know we are aware there are newer versions and we don't care

  - uses: patch
    with:
      # https://gitlab.alpinelinux.org/alpine/aports/-/blob/aea3964a20735cc7237dfaca0a496fc6bfe0b835/community/freeglut/gcc-15.patch
      patches: gcc-15.patch

  - uses: cmake/configure
    with:
      opts: |
        -DFREEGLUT_BUILD_STATIC_LIBS=0

  - uses: cmake/build

  - uses: cmake/install

  - uses: strip

subpackages:
  - name: freeglut-dev
    description: freeglut dev
    pipeline:
      - uses: split/dev
    test:
      pipeline:
        - uses: test/pkgconf
        - uses: test/tw/ldd-check

update:
  enabled: true
  release-monitor:
    identifier: 846

test:
  pipeline:
    - uses: test/tw/ldd-check
