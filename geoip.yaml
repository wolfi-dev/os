package:
  name: geoip
  version: 1.6.12
  epoch: 5
  description: Lookup countries by IP addresses
  copyright:
    - license: LGPL-2.1

environment:
  contents:
    packages:
      - autoconf
      - automake
      - build-base
      - busybox
      - ca-certificates-bundle
      - gtk-doc
      - intltool
      - libtool
      - zlib-dev

pipeline:
  - uses: git-checkout
    with:
      repository: https://github.com/maxmind/geoip-api-c
      tag: v${{package.version}}
      expected-commit: 4b526e7331ca1d692b74a0509ddcc725622ed31a

  - runs: ./bootstrap

  - uses: autoconf/configure

  - uses: autoconf/make

  - uses: autoconf/make-install

  - uses: strip

subpackages:
  - name: geoip-dev
    pipeline:
      - uses: split/dev
    dependencies:
      runtime:
        - geoip
    description: geoip dev
    test:
      pipeline:
        - uses: test/pkgconf
        - uses: test/tw/ldd-check

  - name: geoip-doc
    pipeline:
      - uses: split/manpages
    description: geoip manpages
    test:
      pipeline:
        - uses: test/docs

update:
  enabled: true
  github:
    identifier: maxmind/geoip-api-c
    strip-prefix: v

test:
  pipeline:
    # AUTOGENERATED
    - runs: |
        geoiplookup --version
        geoiplookup6 --version
        geoiplookup --help
        geoiplookup6 --help
    - uses: test/tw/ldd-check
