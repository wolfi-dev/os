From 22d0daf7abd2e89fbd46e194b5ed633766e4169f Mon Sep 17 00:00:00 2001
From: ajayk <ajaykemparaj@gmail.com>
Date: Fri, 1 Aug 2025 19:32:21 -0700
Subject: [PATCH] [PATCH] Backport 9.1 feature to honor default keystore type

---
 .../org/gradle/internal/encryption/impl/KeyStoreKeySource.kt    | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/platforms/core-configuration/encryption-services/src/main/kotlin/org/gradle/internal/encryption/impl/KeyStoreKeySource.kt b/platforms/core-configuration/encryption-services/src/main/kotlin/org/gradle/internal/encryption/impl/KeyStoreKeySource.kt
index 0e2e7dfb89c..87ed6c0d073 100644
--- a/platforms/core-configuration/encryption-services/src/main/kotlin/org/gradle/internal/encryption/impl/KeyStoreKeySource.kt
+++ b/platforms/core-configuration/encryption-services/src/main/kotlin/org/gradle/internal/encryption/impl/KeyStoreKeySource.kt
@@ -124,7 +124,7 @@ class KeyStoreKeySource(
 
     companion object {
         // JKS does not support non-PrivateKeys
-        const val KEYSTORE_TYPE = "pkcs12"
+        val KEYSTORE_TYPE = if (KeyStore.getDefaultType() == "jks") "pkcs12" else KeyStore.getDefaultType()
         private val KEYSTORE_PASSWORD = charArrayOf('c', 'c')
         // Keystore should only be readable by owner
         private val KEYSTORE_FILE_PERMISSIONS = "0600".toInt(8)
-- 
2.39.5 (Apple Git-154)

