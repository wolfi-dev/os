package:
  name: groff
  version: 1.23.0
  epoch: 3
  description: GNU troff text-formatting system
  copyright:
    - license: GPL-3.0-or-later

environment:
  contents:
    packages:
      - autoconf
      - automake
      - bison
      - build-base
      - busybox
      - ca-certificates-bundle
      - libuuid
      - openssf-compiler-options
      - perl
      - texinfo
      - zlib-dev

pipeline:
  - uses: fetch
    with:
      expected-sha256: 6b9757f592b7518b4902eb6af7e54570bdccba37a871fddb2d30ae3863511c13
      uri: https://ftp.gnu.org/gnu/groff/groff-${{package.version}}.tar.gz

  - uses: autoconf/configure
    with:
      opts: |
        --without-x \
        --disable-rpath

  - uses: autoconf/make

  - uses: autoconf/make-install

  - runs: |
      rm -rf ${{targets.destdir}}/usr/lib/charset.alias
      rmdir -p ${{targets.destdir}}/usr/lib 2>/dev/null || true

      # Prevent conflict with mandoc-doc
      rm -f ${{targets.destdir}}/usr/share/man/man1/soelim.1 \
        ${{targets.destdir}}/usr/share/man/man7/roff.7

  - uses: strip

subpackages:
  - name: groff-doc
    pipeline:
      - uses: split/manpages
    description: groff manpages

  - name: groff-info
    pipeline:
      - uses: split/infodir
    description: groff info

update:
  enabled: true
  release-monitor:
    identifier: 1253

test:
  pipeline:
    # AUTOGENERATED
    - runs: |
        addftinfo --version
        afmtodit --version
        chem --version
        eqn --version
        eqn2graph --version
        gdiffmk --version
        gperl --version
        gpinyin --version
        grap2graph --version
        grn --version
        grodvi --version
        groff --version
        grog --version
        grolbp --version
        grolj4 --version
        gropdf --version
        grops --version
        grotty --version
        hpftodit --version
        indxbib --version
        lkbib --version
        lookbib --version
        mmroff --version
        neqn --version
        nroff --version
        pdfmom --version
        pdfroff --version
        pfbtops --version
        pic --version
        pic2graph --version
        post-grohtml --version
        pre-grohtml --version
        preconv --version
        refer --version
        soelim --version
        tbl --version
        tfmtodit --version
        troff --version
        addftinfo --help
        afmtodit --help
        chem --help
        eqn --help
        eqn2graph --help
        gperl --help
        gpinyin --help
        grap2graph --help
        grn --help
        grodvi --help
        groff --help
        grog --help
        grolbp --help
        grolj4 --help
        gropdf --help
        grops --help
        grotty --help
        hpftodit --help
        indxbib --help
        lkbib --help
        lookbib --help
        mmroff --help
        neqn --help
        nroff --help
        pdfmom --help
        pdfroff --help
        pfbtops --help
        pic --help
        pic2graph --help
        post-grohtml --help
        pre-grohtml --help
        preconv --help
        refer --help
        soelim --help
        tbl --help
        tfmtodit --help
        troff --help
