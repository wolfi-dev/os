package:
  name: gtk-2.0
  version: 2.24.33
  epoch: 6
  description: The GTK+ Toolkit (v2)
  copyright:
    - license: LGPL-2.0-or-later
  dependencies:
    runtime:
      - gtk-update-icon-cache

environment:
  contents:
    packages:
      - at-spi2-core-dev
      - autoconf
      - automake
      - build-base
      - busybox
      - ca-certificates-bundle
      - cairo-dev
      - cups-dev
      - expat-dev
      - fribidi-dev
      - gdk-pixbuf-dev
      - gettext-dev
      - glib-dev
      - glib-gir
      - gobject-introspection-dev
      - gtk-doc
      - harfbuzz-dev
      - hicolor-icon-theme
      - intltool
      - libatk-1.0
      - libatk-bridge-2.0
      - libice-dev
      - libjpeg-turbo-dev
      - libtool
      - libx11-dev
      - libxcomposite-dev
      - libxcursor-dev
      - libxdamage-dev
      - libxext-dev
      - libxfixes-dev
      - libxft-dev
      - libxi-dev
      - libxrandr-dev
      - pango-dev
      - shared-mime-info
      - tiff-dev
      - zlib-dev
  environment:
    CFLAGS: -Wno-deprecated-declarations -Wno-unused-but-set-variable -Wno-incompatible-pointer-types -Wno-implicit-int

pipeline:
  - uses: fetch
    with:
      expected-sha256: ac2ac757f5942d318a311a54b0c80b5ef295f299c2a73c632f6bfb1ff49cc6da
      uri: https://download.gnome.org/sources/gtk+/2.24/gtk+-${{package.version}}.tar.xz

  - uses: autoconf/configure

  - uses: autoconf/make

  - uses: autoconf/make-install

  - uses: strip

subpackages:
  - name: ${{package.name}}-dev
    pipeline:
      - uses: split/dev
    dependencies:
      runtime:
        - at-spi2-core-dev
        - cairo-dev
        - intltool
        - libxdamage-dev
        - pango-dev
        - shared-mime-info
    description: gtk+2.0 dev
    test:
      pipeline:
        - uses: test/pkgconf
        - uses: test/tw/ldd-check

  - name: ${{package.name}}-doc
    pipeline:
      - uses: split/manpages
      - runs: |
          mkdir -p "${{targets.subpkgdir}}"/usr/share
          mv "${{targets.destdir}}"/usr/share/gtk-doc "${{targets.subpkgdir}}"/usr/share/
    description: gtk+2.0 manpages
    test:
      pipeline:
        - uses: test/docs

  - name: ${{package.name}}-lang
    pipeline:
      - uses: split/locales
    description: gtk+2.0 locales

  - name: ${{package.name}}-update-icon-cache
    description: Icon theme caching utility
    dependencies:
      provides:
        - gtk-update-icon-cache=${{package.full-version}}
    pipeline:
      - runs: |
          mkdir -p "${{targets.contextdir}}/usr/bin"

          # Move gtk-update-icon-cache binary to subpackage
          mv "${{targets.destdir}}/usr/bin/gtk-update-icon-cache" "${{targets.contextdir}}/usr/bin/"
    test:
      pipeline:
        - runs: |
            gtk-update-icon-cache --help

update:
  enabled: true
  release-monitor:
    identifier: 311540

test:
  pipeline:
    - uses: test/tw/help-check
      with:
        bins: gtk-update-icon-cache
    - uses: test/tw/ldd-check
