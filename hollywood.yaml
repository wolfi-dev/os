package:
  name: hollywood
  version: "1.22"
  epoch: 0
  description: "fill your console with Hollywood melodrama technobabble"
  copyright:
    - license: Apache-2.0
  dependencies:
    runtime:
      - byobu
      - tmux

environment:
  contents:
    packages:
      - busybox
      - ca-certificates-bundle
      - wolfi-base

pipeline:
  - uses: git-checkout
    with:
      repository: https://github.com/dustinkirkland/hollywood
      expected-commit: fa93536a7ce1f2697da2016ee09937d113e259b3
      branch: master

  - runs: |
      mkdir -p "${{targets.destdir}}"/usr/bin
      mkdir -p "${{targets.destdir}}"/usr/lib
      mkdir -p "${{targets.destdir}}"/usr/share/man/man1
      mkdir -p "${{targets.destdir}}"/usr/share

      install -m 755 bin/hollywood "${{targets.destdir}}"/usr/bin/
      cp -a lib/hollywood "${{targets.destdir}}"/usr/lib/
      install -m 644 share/man/man1/hollywood.1 "${{targets.destdir}}"/usr/share/man/man1/
      cp -a share/hollywood "${{targets.destdir}}"/usr/share/

update:
  enabled: true
  git: {}

test:
  environment:
    contents:
      packages:
        - byobu
        - tmux
  pipeline:
    - runs: |
        # Verify hollywood binary exists and is executable
        stat /usr/bin/hollywood
        # Verify lib scripts exist
        stat /usr/lib/hollywood/htop
        # Check script syntax (bash -n checks for syntax errors without executing)
        bash -n /usr/bin/hollywood

subpackages:
  - name: hollywood-doc
    description: hollywood documentation
    pipeline:
      - uses: split/manpages
    test:
      pipeline:
        - uses: test/docs
