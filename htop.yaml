package:
  name: htop
  version: "3.4.1"
  epoch: 4
  description: "A cross-platform interactive process viewer."
  copyright:
    - license: GPL-2.0-or-later

environment:
  contents:
    packages:
      - autoconf
      - automake
      - build-base
      - busybox
      - libcap-dev
      - libnl3-dev
      - linux-headers
      - ncurses-dev
      - ncurses-static
      - pkgconf-dev

pipeline:
  - uses: git-checkout
    with:
      repository: https://github.com/htop-dev/htop
      expected-commit: 348c0a6bf4f33571835a0b6a1a0f5deb15132128
      tag: ${{package.version}}

  - runs: ./autogen.sh

  - uses: autoconf/configure
    with:
      opts: |
        --prefix="/usr" \
        --sysconfdir="/etc" \
        --mandir="/usr/share/man" \
        --localstatedir="/var" \
        --enable-cgroup \
        --enable-capabilities \
        --enable-delayacct \
        --enable-taskstats

  - uses: autoconf/make

  - uses: autoconf/make-install

  - uses: strip

subpackages:
  - name: htop-doc
    description: htop docs
    pipeline:
      - uses: split/manpages
    test:
      pipeline:
        - uses: test/docs

update:
  enabled: true
  github:
    identifier: htop-dev/htop

test:
  pipeline:
    # AUTOGENERATED
    - runs: |
        htop --version
        htop --help
