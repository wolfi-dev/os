package:
  name: libkqueue
  version: 2.6.3
  epoch: 1
  description: "A userspace library providing a portable implementation of the BSD kqueue(2) event notification mechanism on non-BSD platforms."
  copyright:
    - license: MIT
  dependencies:
    runtime:
      - merged-lib
      - wolfi-baselayout

environment:
  contents:
    packages:
      - build-base
      - cmake-3
      - ca-certificates-bundle

pipeline:
  - uses: git-checkout
    with:
      expected-commit: fbe0c77f972b6ab288676e72a1a3c56cbd21f2a0
      repository: https://github.com/mheily/libkqueue.git
      tag: v${{package.version}}

  - uses: cmake/configure

  - uses: cmake/build

  - uses: cmake/install

  - uses: strip

subpackages:
  - name: libkqueue-dev
    description: "libkqueue development headers"
    pipeline:
      - uses: split/dev
    dependencies:
      runtime:
        - merged-lib
        - wolfi-baselayout

test:
  environment:
    contents:
      packages:
        - libkqueue
  pipeline:
    - uses: test/hardening-check
      with:
        package-match: "libkqueue"
    - uses: test/tw/ldd-check
