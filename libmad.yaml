package:
  name: libmad
  version: "0.15.1b"
  epoch: 0
  description: A high-quality MPEG audio decoder
  url: www.underbit.com/products/mad/
  copyright:
    - license: GPL-2.0-or-later

environment:
  contents:
    packages:
      - autoconf
      - automake
      - build-base

pipeline:
  - uses: git-checkout
    with:
      repository: https://github.com/markjeee/libmad
      branch: master
      expected-commit: c2f96fa4166446ac99449bdf6905f4218fb7d6b5

  - uses: patch
    with:
      patches: automake.patch length-check.patch libmad-0.15.1b-cflags-O2.patch libmad-0.15.1b-cflags.patch libmad.thumb.patch md_size.patch Provide-Thumb-2-alternative-code-for-MAD_F_MLN.patch

  - uses: autoconf/configure
    with:
      opts: --enable-accuracy

  - uses: autoconf/make

  - uses: autoconf/make-install

  - uses: strip

subpackages:
  - name: ${{package.name}}-dev
    pipeline:
      - uses: split/dev
    dependencies:
      runtime:
        - libmad
    description: libmad dev
    test:
      pipeline:
        - uses: test/pkgconf

update:
  enabled: true
  release-monitor:
    identifier: 21487
