package:
  name: libptytty
  version: 2.0
  epoch: 2 # go/wolfi-rsc/libptytty
  description: A library that allows for OS independent and secure pty/tty and utmp/wtmp/lastlog handling
  copyright:
    - license: GPL-2.0-or-later
  resources:
    cpu: "1"
    memory: 4Gi

environment:
  contents:
    packages:
      - build-base
      - cmake

pipeline:
  - uses: fetch
    with:
      expected-sha256: 8033ed3aadf28759660d4f11f2d7b030acf2a6890cb0f7926fb0cfa6739d31f7
      uri: http://dist.schmorp.de/libptytty/libptytty-${{package.version}}.tar.gz

  - uses: cmake/configure

  - uses: cmake/build

  - uses: cmake/install

  - uses: strip

subpackages:
  - name: ${{package.name}}-doc
    pipeline:
      - uses: split/manpages
    description: ${{package.name}} manpages
    # test added by a robot (doc)
    test:
      pipeline:
        - uses: test/docs

  - name: ${{package.name}}-dev
    pipeline:
      - uses: split/dev
    dependencies:
      runtime:
        - soxr
    description: ${{package.name}} dev
    test:
      pipeline:
        - uses: test/pkgconf
        - uses: test/tw/ldd-check

update:
  enabled: true
  release-monitor:
    identifier: 239552

test:
  pipeline:
    - uses: test/tw/ldd-check
