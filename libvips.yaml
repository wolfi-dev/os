package:
  name: libvips
  version: "8.17.0"
  epoch: 0
  description: "A fast image processing library with low memory needs"
  copyright:
    - license: LGPL-2.1-or-later

environment:
  contents:
    packages:
      - bubblewrap
      - build-base
      - busybox
      - cmake
      - expat-dev
      - glib-dev
      - libexif-dev
      - libjpeg-turbo-dev
      - librsvg-dev
      - meson

pipeline:
  - uses: git-checkout
    with:
      repository: https://github.com/libvips/libvips
      expected-commit: 603730e50f486bf731cd9ba133fb05c230728c5e
      tag: v${{package.version}}

  - uses: meson/configure

  - uses: meson/compile

  - uses: meson/install

  - uses: strip

subpackages:
  - name: libvips-dev
    pipeline:
      - uses: split/dev
    test:
      pipeline:
        - uses: test/pkgconf
        - uses: test/tw/ldd-check

  - name: libvips-doc
    pipeline:
      - uses: split/manpages
    test:
      pipeline:
        - uses: test/docs

update:
  enabled: true
  ignore-regex-patterns:
    - ".*-beta"
    - ".*-rc\\d+$"
  github:
    identifier: libvips/libvips
    strip-prefix: v

test:
  pipeline:
    # AUTOGENERATED
    - runs: |
        vips --version
        vipsedit --help
        vipsheader --version
        vipsthumbnail --version
        vips --help
        vipsheader --help
        vipsthumbnail --help
    - uses: test/tw/ldd-check
