package:
  name: openbox
  version: 3.6.1
  epoch: 2
  description: A highly configurable and standards-compliant X11 window manager
  copyright:
    - license: GPL-2.0-or-later

environment:
  contents:
    packages:
      - autoconf
      - automake
      - build-base
      - busybox
      - ca-certificates-bundle
      - cairo-dev
      - curl
      - expat-dev
      - fontconfig-dev
      - fribidi-dev
      - gettext-dev
      - glib-dev
      - harfbuzz-dev
      - imlib2-dev
      - librsvg-dev
      - libtool
      - libxcursor-dev
      - libxft-dev
      - libxinerama-dev
      - libxml2-dev
      - libxrandr-dev
      - libxrender-dev
      - openssf-compiler-options
      - pango-dev
      - startup-notification-dev

pipeline:
  - uses: fetch
    with:
      expected-sha256: 8b4ac0760018c77c0044fab06a4f0c510ba87eae934d9983b10878483bde7ef7
      uri: https://openbox.org/dist/openbox/openbox-${{package.version}}.tar.gz

  - runs: |
      echo "deleting libtool archive files before running configure"
      find /usr -type f -name "*.la" -exec echo {} \; -exec rm {} \;

  - uses: autoconf/configure

  - uses: autoconf/make

  - runs: |
      builddir=$(pwd)
      gcc $CFLAGS $LDFLAGS -o setlayout "$builddir"/setlayout.c -lX11

  - uses: autoconf/make-install

  - runs: |
      builddir=$(pwd)
      install "$builddir"/setlayout "${{targets.destdir}}"/usr/bin/setlayout

  - uses: strip

subpackages:
  - name: openbox-dev
    pipeline:
      - uses: split/dev
    dependencies:
      runtime:
        - openbox
        - libxcursor-dev
        - libxinerama-dev
        - libxrandr-dev
        - startup-notification-dev
    description: openbox dev
    test:
      pipeline:
        - uses: test/pkgconf

  - name: openbox-doc
    pipeline:
      - uses: split/manpages
    description: openbox manpages

update:
  enabled: true
  release-monitor:
    identifier: 2541

test:
  pipeline:
    # AUTOGENERATED
    - runs: |
        gdm-control --version
        gnome-panel-control --version
        openbox --version
        openbox-gnome-session --version
        openbox-kde-session --version
        openbox-session --version
        gdm-control --help
        gnome-panel-control --help
        openbox --help
        openbox-gnome-session --help
        openbox-kde-session --help
        openbox-session --help
