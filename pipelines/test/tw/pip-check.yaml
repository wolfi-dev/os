name: Python Package Dependency Validator

description: |
  Validates Python package dependencies are correctly installed and compatible using pip check.
  This test runs 'pip check' to verify that all package dependencies are satisfied and there are
  no version conflicts in the Python environment. Essential for validating Python packages
  have proper dependency declarations.

needs:
  packages:
    - tw-pip-check

inputs:
  python:
    description: |
      Path to the Python interpreter to use for pip check.
      Use 'DEFAULT' to auto-detect the Python version, or specify a path like 'python3.11' or '/usr/bin/python3.12'.
    default: DEFAULT

# USAGE EXAMPLES:
#
# Basic check (auto-detect Python version):
#   - uses: test/tw/pip-check
#
# Check with specific Python version:
#   - uses: test/tw/pip-check
#     with:
#       python: python3.11
#
pipeline:
  - name: "pip check"
    runs: |
      set +x
      python="${{inputs.python}}"

      if [ "$python" = "DEFAULT" ]; then
        tw-pip-check
      else
        tw-pip-check --python="$python"
      fi
