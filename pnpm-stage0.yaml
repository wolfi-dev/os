package:
  name: pnpm-stage0
  version: 8.7.4
  epoch: 3
  description: "Fast, disk space efficient package manager"
  copyright:
    - license: MIT
  dependencies:
    runtime:
      - nodejs-18
    provides:
      - pnpm=8.7.4

environment:
  contents:
    packages:
      - autoconf
      - automake
      - build-base
      - ca-certificates-bundle
      - curl
      - gcc-12
      - git
      - make
      - nodejs-18
      - npm
      - typescript
      - wolfi-base

pipeline:
  - runs: |
      npm install pnpm@${{package.version}} -g
      mkdir -p "${{targets.destdir}}"/usr/lib/node_modules/pnpm
      mkdir -p "${{targets.destdir}}"/usr/bin
      mv /usr/local/lib/node_modules/pnpm/* "${{targets.destdir}}"/usr/lib/node_modules/pnpm
      ln -sf /usr/lib/node_modules/pnpm/bin/pnpm.cjs  "${{targets.destdir}}"/usr/bin/pnpm
      ln -sf /usr/lib/node_modules/pnpm/bin/pnpx.cjs  "${{targets.destdir}}"/usr/bin/pnpx

update:
  enabled: false
  exclude-reason: "don't auto update stage 0 packages"
  github:
    identifier: pnpm/pnpm
    strip-prefix: v
    tag-filter: v
    use-tag: true

test:
  pipeline:
    # AUTOGENERATED
    - runs: |
        pnpm --version
        pnpm --help
