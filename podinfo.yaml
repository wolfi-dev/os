package:
  name: podinfo
  version: "6.9.0"
  epoch: 0
  description: Podinfo is a tiny web application made with Go
  copyright:
    - license: Apache-2.0
  dependencies:
    runtime:
      - "curl"
      - "netcat-openbsd"
      - "ca-certificates"

pipeline:
  - uses: git-checkout
    with:
      repository: https://github.com/stefanprodan/podinfo
      tag: ${{package.version}}
      expected-commit: fb3b01be30a3f353b221365cd3b4f9484a0885ea

  - uses: go/build
    with:
      packages: ./cmd/podinfo
      install-dir: /home/app
      prefix: /
      output: podinfo

  - runs: | 
      mkdir -p ${{targets.contextdir}}/home/app
      cp -r ui ${{targets.contextdir}}/home/app/ui

update:
  enabled: true
  github:
    identifier: stefanprodan/podinfo

test:
  environment:
    environment:
  pipeline:
    - name: Check application responds to --help command
      runs: /home/app/podinfo --help
    - name: Check application responds to --version flag
      runs: /home/app/podinfo --version