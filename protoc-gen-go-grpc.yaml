package:
  name: protoc-gen-go-grpc
  version: "1.6.0"
  epoch: 1 # CVE-2025-61729
  description: Go support for Google's protocol buffers services
  copyright:
    - license: Apache-2.0

pipeline:
  - uses: git-checkout
    with:
      repository: https://github.com/grpc/grpc-go
      tag: cmd/protoc-gen-go-grpc/v${{package.version}}
      expected-commit: 749af0c872456932847a676848bffc42e4e2f4d3

  - uses: go/build
    with:
      packages: .
      modroot: ./cmd/protoc-gen-go-grpc
      output: protoc-gen-go-grpc

  - uses: strip

update:
  enabled: true
  github:
    identifier: grpc/grpc-go
    strip-prefix: cmd/protoc-gen-go-grpc/v
    tag-filter: cmd/protoc-gen-go-grpc/
    use-tag: true

test:
  pipeline:
    - runs: |
        protoc-gen-go-grpc --version
        protoc-gen-go-grpc --help
