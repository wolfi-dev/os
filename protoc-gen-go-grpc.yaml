package:
  name: protoc-gen-go-grpc
  version: "1.6.1"
  epoch: 0 # go/wolfi-rsc/protoc-gen-go-grpc
  description: Go support for Google's protocol buffers services
  copyright:
    - license: Apache-2.0
  resources:
    cpu: "1"
    memory: 1Gi

pipeline:
  - uses: git-checkout
    with:
      repository: https://github.com/grpc/grpc-go
      tag: cmd/protoc-gen-go-grpc/v${{package.version}}
      expected-commit: 830c9098e4d034e0c7641e1fbc6001c2570bbc0f

  - uses: go/build
    with:
      packages: .
      modroot: ./cmd/protoc-gen-go-grpc
      output: protoc-gen-go-grpc

  - uses: strip

update:
  enabled: true
  github:
    identifier: grpc/grpc-go
    strip-prefix: cmd/protoc-gen-go-grpc/v
    tag-filter: cmd/protoc-gen-go-grpc/
    use-tag: true

test:
  pipeline:
    - runs: |
        protoc-gen-go-grpc --version
        protoc-gen-go-grpc --help
