Subject: Fix QProcess environment variables for Node.js server
Upstream: No (custom patch for Wolfi/Debian packaging)
Origin: https://salsa.debian.org/mendezr/stremio
Author: Juan Manuel MÃ©ndez Rey <vejeta@gmail.com>

This patch ensures that QProcess has the necessary environment variables
(HOME, USER, PWD) when starting the Node.js server process. Without these
variables, the Node.js server may fail to start or behave incorrectly.

This is particularly important in containerized or sandboxed environments
where environment variables may not be automatically inherited.

---
--- a/stremioprocess.cpp
+++ b/stremioprocess.cpp
@@ -1,4 +1,7 @@
 #include "stremioprocess.h"
+#include <QDir>
+#include <QProcessEnvironment>
+#include <QStandardPaths>
 
 #ifdef WIN32
 #include <windows.h>
@@ -36,6 +38,19 @@ void Process::start(const QString &program, const QVariantList &arguments, QStr
 #endif
 
     QStringList args;
+
+    // Fix: QProcess needs environment variables for Node.js server
+    QProcessEnvironment env = QProcessEnvironment::systemEnvironment();
+    if (!env.contains("HOME")) {
+        env.insert("HOME", QStandardPaths::writableLocation(QStandardPaths::HomeLocation));
+    }
+    if (!env.contains("USER")) {
+        env.insert("USER", qgetenv("USER"));
+    }
+    if (!env.contains("PWD")) {
+        env.insert("PWD", QDir::currentPath());
+    }
+    this->setProcessEnvironment(env);
 
     // convert QVariantList from QML to QStringList for QProcess
