Subject: Completely disable SystemTray to prevent QtWebEngine SIGTRAP
Upstream: No (Wolfi/container-specific fix)
Author: Juan Manuel MÃ©ndez Rey <vejeta@gmail.com>

SystemTray causes QtWebEngine to crash with SIGTRAP when D-Bus is unavailable.
This patch disables SystemTray creation in main.cpp and comments out all calls in main.qml.

Changes:
- main.cpp: Comment out SystemTray creation (lines 117-118)
- main.qml: Comment out systemTray.hideIconTray() call in quitApp()
- main.qml: Disable Connections block by setting target to null
- main.qml: Comment out all systemTray method calls

CRITICAL: This patch prevents SystemTray instantiation completely by disabling
creation in main.cpp, avoiding SIGTRAP in containerized environments without D-Bus.

This patch is generated based on the state AFTER applying patches 001-007,
following the sequential patch methodology documented in MELANGE_PATCHING_SOLUTION.md

---
diff --git a/main.cpp b/main.cpp
index 924f49a..a333361 100644
--- a/main.cpp
+++ b/main.cpp
@@ -113,9 +113,10 @@ int main(int argc, char **argv)

     engine->load(QUrl(QStringLiteral("qrc:/main.qml")));

+    // SystemTray disabled for Wolfi - causes SIGTRAP without D-Bus
     // Create SystemTray after QML engine is loaded and ready
-    SystemTray * systemTray = new SystemTray();
-    engine->rootContext()->setContextProperty("systemTray", systemTray);
+    // SystemTray * systemTray = new SystemTray();
+    // engine->rootContext()->setContextProperty("systemTray", systemTray);

     #ifndef Q_OS_MACOS
     QObject::connect( &app, QOverload<quint32, QByteArray>::of(&CompatibleSingleApp::receivedMessage),
diff --git a/main.qml b/main.qml
index 870fcc7..46893c8 100644
--- a/main.qml
+++ b/main.qml
@@ -166,21 +166,23 @@ ApplicationWindow {
     function quitApp() {
         root.quitting = true;
         webView.destroy();
-        systemTray.hideIconTray();
+        // SystemTray disabled for Wolfi - causes SIGTRAP without D-Bus
+        // systemTray.hideIconTray();
         streamingServer.kill();
         streamingServer.waitForFinished(1500);
         Qt.quit();
     }

-    /* With help Connections object
+    /* SystemTray Connections disabled for Wolfi - causes SIGTRAP without D-Bus
+     * With help Connections object
      * set connections with System tray class
      * */
     Connections {
-        target: systemTray
+        target: null  // SystemTray disabled

         function onSignalIconMenuAboutToShow() {
-            systemTray.updateIsOnTop((root.flags & Qt.WindowStaysOnTopHint) === Qt.WindowStaysOnTopHint);
-	        systemTray.updateVisibleAction(root.visible);
+            // systemTray.updateIsOnTop((root.flags & Qt.WindowStaysOnTopHint) === Qt.WindowStaysOnTopHint);
+	        // systemTray.updateVisibleAction(root.visible);
         }

         function onSignalShow() {
@@ -612,7 +614,8 @@ ApplicationWindow {

     onVisibilityChanged: {
         var enabledAlwaysOnTop = root.visible && root.visibility != Window.FullScreen;
-        systemTray.alwaysOnTopEnabled(enabledAlwaysOnTop);
+        // SystemTray disabled for Wolfi - causes SIGTRAP without D-Bus
+        // systemTray.alwaysOnTopEnabled(enabledAlwaysOnTop);
         if (!enabledAlwaysOnTop) {
             root.flags &= ~Qt.WindowStaysOnTopHint;
         }
