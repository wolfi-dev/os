package:
  name: tcptraceroute
  version: 1.5_beta7
  epoch: 3
  description: Display route path using TCP probes
  copyright:
    - license: LGPL-2.0-or-later

environment:
  contents:
    packages:
      - autoconf
      - automake
      - build-base
      - busybox
      - ca-certificates-bundle
      - gettext-dev
      - libevent-dev
      - libnet-dev
      - libpcap-dev

var-transforms:
  - from: ${{package.version}}
    match: \_beta7
    replace: beta7
    to: mangled-package-version

pipeline:
  - uses: git-checkout
    with:
      repository: https://github.com/mct/tcptraceroute.git
      expected-commit: 086a47f75f271fd55d4104a7bfc31bf1c960dd1d
      tag: tcptraceroute-${{vars.mangled-package-version}}

  - uses: autoconf/configure
    with:
      opts: |
        --host=${{host.triplet.gnu}} \
        --build=${{host.triplet.gnu}} \
        --prefix=/usr \
        --sysconfdir=/etc \
        --mandir=/usr/share/man \
        --infodir=/usr/share/info

  - uses: autoconf/make

  - uses: autoconf/make-install

  - uses: strip

subpackages:
  - name: tcptraceroute-doc
    pipeline:
      - uses: split/manpages
    test:
      pipeline:
        - uses: test/docs

update:
  enabled: false
  exclude-reason: |
    Upstream have not have any new commits since 2007. Probably no updates will be there anymore.
    We are building the beta7 which is the last version, as our automation skips tags with "beta" in them
    we can't configure automatic updates.

test:
  pipeline:
    # AUTOGENERATED
    - runs: |
        tcptraceroute --version
