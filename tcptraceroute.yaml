package:
  name: tcptraceroute
  version: 1.5_beta7
  epoch: 3
  description: Display route path using TCP probes
  copyright:
    - license: LGPL-2.0-or-later

environment:
  contents:
    packages:
      - autoconf
      - automake
      - build-base
      - busybox
      - ca-certificates-bundle
      - gettext-dev
      - libevent-dev
      - libnet-dev
      - libpcap-dev

var-transforms:
  - from: ${{package.version}}
    match: \_beta7
    replace: beta7
    to: mangled-package-version

pipeline:
  - uses: fetch
    with:
      uri: https://github.com/mct/tcptraceroute/archive/tcptraceroute-${{vars.mangled-package-version}}.tar.gz
      expected-sha512: ad5588e62a56f1b5fa851b68280a88e66a900777fe4fd67587262245cd9da17b536b7dc972abe540fc124a93ac76abcabbc55bc32f9f8ee872d5df57b08f7222

  - uses: autoconf/configure
    with:
      opts: |
        --host=${{host.triplet.gnu}} \
        --build=${{host.triplet.gnu}} \
        --prefix=/usr \
        --sysconfdir=/etc \
        --mandir=/usr/share/man \
        --infodir=/usr/share/info

  - uses: autoconf/make

  - uses: autoconf/make-install

  - uses: strip

subpackages:
  - name: tcptraceroute-doc
    pipeline:
      - uses: split/manpages
    test:
      pipeline:
        - uses: test/docs

update:
  enabled: false
  manual: true

test:
  pipeline:
    # AUTOGENERATED
    - runs: |
        tcptraceroute --version
