package:
  name: testscript
  version: 1.13.1
  epoch: 0
  description: Package testscript provides support for defining filesystem-based tests by creating scripts in a directory.
  copyright:
    - license: BSD-3-Clause

pipeline:
  - uses: git-checkout
    with:
      repository: https://github.com/rogpeppe/go-internal
      tag: v${{package.version}}
      expected-commit: e67a4aa07a58fd7f4cc884153739cb77b34f0edb

  - uses: go/build
    with:
      output: testscript
      packages: ./cmd/testscript

  - uses: strip

update:
  enabled: true
  github:
    identifier: rogpeppe/go-internal
    strip-prefix: v

test:
  pipeline:
    - name: "Verify basic testscript functionality"
      runs: |
        mkdir testdata
        cat <<EOF > testdata/basic.txt
        # Basic command execution
        exec echo "hello world"
        stdout 'hello world'
        ! stderr .
        EOF

        testscript testdata/basic.txt
