package:
  name: wireplumber
  version: 0.5.10
  epoch: 0
  description: Session / policy manager implementation for PipeWire
  copyright:
    - license: MIT

environment:
  contents:
    packages:
      - build-base
      - busybox
      - doxygen
      - glib-gir
      - gobject-introspection-dev
      - lua5.4-dev
      - pipewire-dev
      - py3-lxml
      - python3
      - systemd-dev

pipeline:
  - uses: git-checkout
    with:
      repository: https://gitlab.freedesktop.org/pipewire/wireplumber.git
      tag: ${{package.version}}
      expected-commit: 7a4d3177550b6b53fe0a49396da5b07f5353daff

  - uses: meson/configure
    with:
      opts: |
        -Dintrospection=enabled \
        -Dsystem-lua=true \
        -Dsystemd-system-service=true \
        -Dsystemd-system-unit-dir=/usr/lib/systemd/system \
        -Dsystemd-system-unit-dir=/usr/lib/systemd/user \
        -Dtests=true \
        -Ddbus-tests=true

  - uses: meson/compile

  - uses: meson/install

  - uses: strip

  
